DROP TABLE if EXISTS historical_data;
DROP TABLE if EXISTS microsoft;
DROP TABLE if EXISTS balance_sheet_data;
DROP TABLE if EXISTS income_statement_data;
DROP TABLE if EXISTS cash_flow_data;

CREATE TABLE historical_data (
    date DATE PRIMARY KEY,
    "open" NUMERIC(12, 4) NOT NULL,
    high NUMERIC(12, 4) NOT NULL,
    low NUMERIC(12, 4) NOT NULL,
    "close" NUMERIC(12, 4) NOT NULL,
    adjusted_close NUMERIC(12, 4) NOT NULL,
    volume BIGINT NOT NULL,
    dividend_amount NUMERIC(12, 4) NOT NULL,
    split_coefficient NUMERIC(12, 4) NOT NULL
);

CREATE TABLE microsoft (
    Symbol VARCHAR(255),
    AssetType VARCHAR(255),
    Name VARCHAR(255),
    Description TEXT,
    Exchange VARCHAR(255),
    Currency VARCHAR(255),
    Country VARCHAR(255),
    Sector VARCHAR(255),
    Industry VARCHAR(255),
    Address VARCHAR(255),
    FiscalYearEnd VARCHAR(255),
    LatestQuarter VARCHAR(255),
    MarketCapitalization VARCHAR(255),
    EPS VARCHAR(255),
    ProfitMargin VARCHAR(255),
    QuarterlyEarningsGrowthYOY VARCHAR(255),
    QuarterlyRevenueGrowthYOY VARCHAR(255),
    AnalystTargetPrice VARCHAR(255),
    Beta VARCHAR(255),
    SharesOutstanding VARCHAR(255),
    DividendDate VARCHAR(255),
    ExDividendDate VARCHAR(255)
);


CREATE TABLE balance_sheet_data (
    fiscalDateEnding TEXT,
    reportedCurrency TEXT,
    totalAssets TEXT,
    totalCurrentAssets TEXT,
    cashAndCashEquivalentsAtCarryingValue TEXT,
    cashAndShortTermInvestments TEXT,
    inventory TEXT,
    currentNetReceivables TEXT,
    totalNonCurrentAssets TEXT,
    propertyPlantEquipment TEXT,
    accumulatedDepreciationAmortizationPPE TEXT,
    intangibleAssets TEXT,
    intangibleAssetsExcludingGoodwill TEXT,
    goodwill TEXT,
    investments TEXT,
    longTermInvestments TEXT,
    shortTermInvestments TEXT,
    otherCurrentAssets TEXT,
    otherNonCurrentAssets TEXT,
    totalLiabilities TEXT,
    totalCurrentLiabilities TEXT,
    currentAccountsPayable TEXT,
    deferredRevenue TEXT,
    currentDebt TEXT,
    shortTermDebt TEXT,
    totalNonCurrentLiabilities TEXT,
    capitalLeaseObligations TEXT,
    longTermDebt TEXT,
    currentLongTermDebt TEXT,
    longTermDebtNoncurrent TEXT,
    shortLongTermDebtTotal TEXT,
    otherCurrentLiabilities TEXT,
    otherNonCurrentLiabilities TEXT,
    totalShareholderEquity TEXT,
    treasuryStock TEXT,
    retainedEarnings TEXT,
    commonStock TEXT,
    commonStockSharesOutstanding TEXT
);

CREATE TABLE income_statement_data (
    fiscalDateEnding DATE,
    reportedCurrency VARCHAR(50),
    grossProfit FLOAT,
    totalRevenue FLOAT,
    costOfRevenue FLOAT,
    costofGoodsAndServicesSold FLOAT,
    operatingIncome FLOAT,
    sellingGeneralAndAdministrative FLOAT,
    researchAndDevelopment FLOAT,
    operatingExpenses FLOAT,
    investmentIncomeNet FLOAT,
    netInterestIncome FLOAT,
    interestIncome TEXT,
    interestExpense FLOAT,
    nonInterestIncome FLOAT,
    otherNonOperatingIncome FLOAT,
    depreciation TEXT,
    depreciationAndAmortization FLOAT,
    incomeBeforeTax FLOAT,
    incomeTaxExpense FLOAT,
    interestAndDebtExpense FLOAT,
    netIncomeFromContinuingOperations FLOAT,
    comprehensiveIncomeNetOfTax FLOAT,
    ebit FLOAT,
    ebitda FLOAT,
    netIncome FLOAT
);


CREATE TABLE cash_flow_data (
    fiscalDateEnding DATE,
    reportedCurrency VARCHAR(50),
    operatingCashflow FLOAT,
    paymentsForOperatingActivities FLOAT,
    proceedsFromOperatingActivities VARCHAR(50),
    changeInOperatingLiabilities FLOAT,
    changeInOperatingAssets FLOAT,
    depreciationDepletionAndAmortization FLOAT,
    capitalExpenditures FLOAT,
    changeInReceivables FLOAT,
    changeInInventory FLOAT,
    profitLoss FLOAT,
    cashflowFromInvestment FLOAT,
    cashflowFromFinancing FLOAT,
    proceedsFromRepaymentsOfShortTermDebt FLOAT,
    paymentsForRepurchaseOfCommonStock FLOAT,
    paymentsForRepurchaseOfEquity FLOAT,
    paymentsForRepurchaseOfPreferredStock VARCHAR(50),
    dividendPayout FLOAT,
    dividendPayoutCommonStock FLOAT,
    dividendPayoutPreferredStock VARCHAR(50),
    proceedsFromIssuanceOfCommonStock FLOAT,
    proceedsFromIssuanceOfLongTermDebtAndCapitalSecuritiesNet VARCHAR(50),
    proceedsFromIssuanceOfPreferredStock VARCHAR(50),
    proceedsFromRepurchaseOfEquity FLOAT,
    proceedsFromSaleOfTreasuryStock VARCHAR(50),
    changeInCashAndCashEquivalents FLOAT,
    changeInExchangeRate VARCHAR(255),
    netIncome FLOAT
);